---
layout: post
title: "Claude Code çš„å‡ é¡¹å…³é”®æŠ€æœ¯ï¼šSubAgentã€Skills..."
permalink: "claude-code-key-technologies"
author: "FS.IO"
date:   2025-11-12 00:00:00
categories: technology
tags: [Claude Code, AIç¼–ç¨‹, SubAgent, Skills]
---

2025å¹´ï¼ŒClaude Code çš„å‡ºç°æ ‡å¿—ç€ AI ç¼–ç¨‹åŠ©æ‰‹è¿›å…¥äº†ä¸€ä¸ªæ–°çš„é˜¶æ®µã€‚å®ƒä¸ä»…æ˜¯ä¸€ä¸ªä»£ç ç”Ÿæˆå·¥å…·ï¼Œæ›´æ˜¯ä¸€ä¸ªå®Œæ•´çš„æŠ€æœ¯æ¶æ„èŒƒä¾‹ã€‚æœ¬æ–‡å°†æ·±å…¥åˆ†æ Claude Code çš„å‡ é¡¹å…³é”®æŠ€æœ¯ã€‚

## ä¸€ã€æ•´ä½“æ¶æ„è®¾è®¡

Claude Code é‡‡ç”¨äº†æ¸…æ™°çš„åˆ†å±‚æ¶æ„ï¼Œè¿™ä½¿å…¶æ—¢å¼ºå¤§åˆæ˜“äºæ‰©å±•ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           äº¤äº’å±‚ (REPL)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         æ ¸å¿ƒå¼•æ“ (query.ts)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      å·¥å…·ç³»ç»Ÿ (Tools + MCP)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      ä¸Šä¸‹æ–‡ç®¡ç† (Context)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### äº¤äº’å±‚

äº¤äº’å±‚æ˜¯ç”¨æˆ·ä¸ Claude Code çš„æ¥è§¦ç‚¹ï¼Œç”±å¤šä¸ªç»„ä»¶æ„æˆï¼š

- **REPL ç•Œé¢**ï¼šæä¾›å‘½ä»¤è¡Œäº¤äº’ä½“éªŒ
- **è¾“å…¥å¤„ç†å™¨**ï¼šè§£æå¤šç§è¾“å…¥æ¨¡å¼
  - `/` å¼€å¤´ï¼šå¤„ç†æ–œæ å‘½ä»¤
  - `!` å¼€å¤´ï¼šæ‰§è¡Œ bash å‘½ä»¤
  - å…¶ä»–ï¼šä½œä¸ºè‡ªç„¶è¯­è¨€å¤„ç†

```typescript
function processUserInput(input: string, mode: InputMode): UserMessage {
  if (input.startsWith('/')) {
    return handleSlashCommand(input);
  } else if (input.startsWith('!')) {
    return handleBashCommand(input.slice(1));
  } else {
    return createUserMessage(input);
  }
}
```

- **è¾“å‡ºæ¸²æŸ“å™¨**ï¼šä½¿ç”¨ Ink æ¡†æ¶æ„å»ºç»ˆç«¯ UIï¼Œæ”¯æŒï¼š
  - ä¸»é¢˜ç³»ç»Ÿåˆ‡æ¢
  - è¯¦ç»†/ç®€æ´æ¨¡å¼
  - æ‰§è¡Œæˆæœ¬å’Œæ—¶é—´æ˜¾ç¤º

### æ ¸å¿ƒå¼•æ“

æ ¸å¿ƒå¼•æ“è´Ÿè´£åè°ƒå„ä¸ªç»„ä»¶çš„å·¥ä½œï¼Œå…¶æ ¸å¿ƒæŸ¥è¯¢æµç¨‹å¦‚ä¸‹ï¼š

```typescript
async function* query(
  messages: Message[],
  systemPrompt: string,
  context: Context,
  canUseTool: CanUseToolFn,
  toolUseContext: ToolUseContext,
): AsyncGenerator<Message> {
  // 1. åˆå§‹åŒ–å¤§æ¨¡å‹ prompt
  const fullSystemPrompt = formatSystemPromptWithContext(systemPrompt, context)

  // 2. è·å–å¤§æ¨¡å‹è¿”å›
  const result = await queryWithBinaryFeedback(
    toolUseContext,
    getAssistantResponse,
    getBinaryFeedbackResponse,
  )

  // 3. å¤„ç†æ¨¡å‹è¿”å›çš„å·¥å…·è¯·æ±‚
  const toolUseMessages = assistantMessage.message.content.filter(
    _ => _.type === 'tool_use',
  )

  // 4. å¹¶è¡Œ/ä¸²è¡Œæ‰§è¡Œå·¥å…·
  if (toolUseMessages.every(msg => toolUseContext.options.tools
    .find(t => t.name === msg.name)?.isReadOnly())) {
    for await (const message of runToolsConcurrently) { }
  } else {
    for await (const message of runToolsSerially) { }
  }

  // 5. å¤„ç†åç»­äº¤äº’
  yield* await query()
}
```

## äºŒã€å·¥å…·ç³»ç»Ÿ

å·¥å…·ç³»ç»Ÿæ˜¯ Claude Code çš„"æ‰‹è„š"ï¼Œä½¿å…¶èƒ½å¤Ÿä¸å¤–éƒ¨ç¯å¢ƒäº¤äº’ã€‚

### å·¥å…·ç±»å‹

- **æ–‡ä»¶å·¥å…·**ï¼šè¯»å–ã€å†™å…¥ã€æœç´¢æ–‡ä»¶
- **æ‰§è¡Œå·¥å…·**ï¼šè¿è¡Œ shell å‘½ä»¤ã€æ‰§è¡Œä»£ç 
- **åˆ†æå·¥å…·**ï¼šä»£ç åˆ†æã€ä¾èµ–æ£€æŸ¥
- **å…ƒå·¥å…·**ï¼šå¤åˆå·¥å…·ï¼Œæ‰§è¡Œå¤æ‚ä»»åŠ¡

### ç»Ÿä¸€æ¥å£

æ‰€æœ‰å·¥å…·éƒ½éµå¾ªç»Ÿä¸€çš„æ¥å£å®šä¹‰ï¼š

```typescript
interface Tool {
  name: string;
  description: string;
  inputSchema: z.ZodType;
  execute(params: any): Promise<ToolResult>;
}
```

### å¼ºå¤§çš„ Bash å·¥å…·

Bash å·¥å…·æ˜¯æœ€å¼ºå¤§çš„å·¥å…·ä¹‹ä¸€ï¼Œå¯ä»¥è°ƒç”¨ shell é‡Œçš„æ‰€æœ‰å‘½ä»¤ã€‚è¿™è®© Claude Code èƒ½å¤Ÿæ‰§è¡Œå‡ ä¹ä»»ä½•ç³»ç»Ÿçº§æ“ä½œã€‚

## ä¸‰ã€ä¸Šä¸‹æ–‡ç®¡ç†

ä¸Šä¸‹æ–‡ç®¡ç†æ˜¯ Claude Code çš„"è®°å¿†"ï¼Œå…¶æ ¸å¿ƒæŒ‘æˆ˜æ˜¯åœ¨æœ‰é™çš„ä¸Šä¸‹æ–‡çª—å£å†…æä¾›æœ€ç›¸å…³çš„ä¿¡æ¯ã€‚

### LRU ç¼“å­˜æœºåˆ¶

```typescript
const fileEncodingCache = new LRUCache<string, BufferEncoding>({
  fetchMethod: path => detectFileEncodingDirect(path),
  ttl: 5 * 60 * 1000,
  ttlAutopurge: false,
  max: 1000,
})
```

### æŒ‰éœ€åŠ è½½ç­–ç•¥

ä¸ä¼šä¸€æ¬¡æ€§åŠ è½½æ•´ä¸ªä»£ç åº“ï¼Œè€Œæ˜¯æ ¹æ®æŸ¥è¯¢éœ€è¦æ™ºèƒ½åŠ è½½ç›¸å…³æ–‡ä»¶ï¼š

```typescript
async *call({ pattern, path }, { abortController }) {
  const { files, truncated } = await glob(
    pattern,
    path ?? getCwd(),
    { limit: 100, offset: 0 },
    abortController.signal,
  )
  const output: Output = {
    filenames: files,
    durationMs: Date.now() - start,
    numFiles: files.length,
    truncated,
  }
  yield {
    type: 'result',
    resultForAssistant: this.renderResultForAssistant(output),
    data: output,
  }
}
```

### ç»“æœæˆªæ–­å¤„ç†

å¯¹å¤§é‡æœç´¢ç»“æœå®ç°æ™ºèƒ½æˆªæ–­ï¼Œé¿å…ä¸Šä¸‹æ–‡æº¢å‡ºï¼š

```typescript
const MAX_LINES = 4
const MAX_FILES = 1000
const TRUNCATED_MESSAGE = `There are more than ${MAX_FILES} files...
`
```

## å››ã€MCP å·¥å…·ç³»ç»Ÿ

MCPï¼ˆModel Context Protocolï¼‰æ˜¯ Claude Code çš„é‡è¦æ‰©å±•æœºåˆ¶ï¼Œæ”¯æŒä¸‰çº§åˆ†å±‚é…ç½®ï¼š

| **çº§åˆ«** | **èŒƒå›´** | **ä¼˜å…ˆçº§** |
|---------|---------|-----------|
| global  | å…¨å±€é…ç½®çš„é€šç”¨ MCP | æœ€ä½ |
| MCPrc   | é…ç½®æ–‡ä»¶ï¼Œå¯å…±äº« | ä¸­ç­‰ |
| project | é¡¹ç›®çº§åˆ«é…ç½® | æœ€é«˜ |

### MCP å·¥å…·èšåˆ

```typescript
export const getMCPTools = memoize(async (): Promise<Tool[]> => {
  const toolsList = await requestAll<ListToolsResult, typeof ListToolsResultSchema>(
    { method: 'tools/list' },
    ListToolsResultSchema,
    'tools',
  )
  // èšåˆæ‰€æœ‰ MCP Server çš„å·¥å…·
  return aggregateTools(toolsList)
})
```

## äº”ã€å­ä»£ç†ï¼ˆSub Agentï¼‰ç³»ç»Ÿ

å­ä»£ç†ï¼ˆSub Agentï¼‰æ˜¯ Claude Code å®ç°ä»»åŠ¡ä¸“ä¸šåŒ–çš„æ ¸å¿ƒæœºåˆ¶ï¼Œå®ƒæ ‡å¿—ç€ AI åŠ©æ‰‹ä»é€šç”¨å‹å‘ä¸“ä¸šåŒ–çš„é‡è¦è½¬å˜ã€‚

![Claude Code SubAgent](/images/claudecodesubagent.webp)

### ä»€ä¹ˆæ˜¯ Sub Agentï¼Ÿ

Sub Agent æœ¬è´¨ä¸Šæ˜¯é¢„é…ç½®çš„ä¸“ä¸š AI åŠ©æ‰‹ï¼Œæ¯ä¸ªéƒ½æ‹¥æœ‰ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ç‹¬ç«‹çš„ä¸Šä¸‹æ–‡çª—å£ï¼ˆå…³é”®ï¼ï¼‰        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     å®šåˆ¶åŒ–çš„ç³»ç»Ÿæç¤ºè¯               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ç‰¹å®šçš„å·¥å…·è®¿é—®æƒé™               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ä¸“ä¸šçš„é¢†åŸŸçŸ¥è¯†                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

è¿™ç§è®¾è®¡ä½¿å¾—æ¯ä¸ª Sub Agent éƒ½èƒ½ä¸“æ³¨äºè‡ªå·±çš„ä¸“ä¸šé¢†åŸŸï¼Œå¦‚ä»£ç å®¡æŸ¥ã€è°ƒè¯•æˆ–æ•°æ®åˆ†æç­‰ã€‚

### æ ¸å¿ƒä¼˜åŠ¿ï¼šä¸Šä¸‹æ–‡éš”ç¦»

**è¿™æ˜¯ Sub Agent æœ€é‡è¦çš„ç‰¹æ€§ï¼Œä¹Ÿæ˜¯ä¸ Skills çš„æœ¬è´¨åŒºåˆ«ã€‚**

#### ä¸ºä»€ä¹ˆä¸Šä¸‹æ–‡éš”ç¦»å¦‚æ­¤é‡è¦ï¼Ÿ

```
åœºæ™¯ï¼šä½ éœ€è¦è¿›è¡Œä»£ç å®¡æŸ¥ï¼Œä½†ä¸å¸Œæœ›ä¸»å¯¹è¯è¢«å¤§é‡ä»£ç ç»†èŠ‚æ±¡æŸ“

âŒ æ²¡æœ‰ Sub Agentï¼š
ä¸»å¯¹è¯ä¸Šä¸‹æ–‡
â”œâ”€â”€ ç”¨æˆ·è¯·æ±‚
â”œâ”€â”€ ä»£ç å®¡æŸ¥ç»†èŠ‚ï¼ˆå¤§é‡ä»£ç ï¼‰
â”œâ”€â”€ å®‰å…¨æ£€æŸ¥ç»“æœ
â”œâ”€â”€ æ€§èƒ½åˆ†æ
â””â”€â”€ ä¸Šä¸‹æ–‡çª—å£è¢«å ç”¨ï¼Œå½±å“åç»­å¯¹è¯

âœ… ä½¿ç”¨ Sub Agentï¼š
ä¸»å¯¹è¯ä¸Šä¸‹æ–‡ï¼ˆä¿æŒæ¸…çˆ½ï¼‰
â””â”€â”€ å§”æ‰˜ç»™ code-reviewer Sub Agent
    â””â”€â”€ ç‹¬ç«‹ä¸Šä¸‹æ–‡çª—å£
        â”œâ”€â”€ å®Œæ•´çš„ä»£ç å®¡æŸ¥ç»†èŠ‚
        â”œâ”€â”€ å®‰å…¨æ£€æŸ¥ç»“æœ
        â””â”€â”€ æ€§èƒ½åˆ†æ
    â””â”€â”€ è¿”å›ç®€æ´çš„å®¡æŸ¥ç»“æœç»™ä¸»å¯¹è¯
```

#### ä¸Šä¸‹æ–‡éš”ç¦»å¸¦æ¥çš„å¥½å¤„

**1. ä¿æŒä¸»å¯¹è¯ä¸“æ³¨**
```
ä¸»å¯¹è¯å§‹ç»ˆå…³æ³¨é«˜å±‚æ¬¡çš„ç›®æ ‡è§„åˆ’
    â†“
Sub Agent å¤„ç†å…·ä½“çš„æŠ€æœ¯ç»†èŠ‚
    â†“
æ¸…æ™°çš„èŒè´£åˆ†ç¦»
```

**2. é¿å…"ä¸Šä¸‹æ–‡æ±¡æŸ“"**
```
ä»£ç å®¡æŸ¥çš„ç»†èŠ‚ä¸ä¼šå½±å“
    â†“
åç»­çš„æ¶æ„è®¨è®º
    â†“
æ¯ä¸ª Sub Agent éƒ½åœ¨è‡ªå·±çš„"æ²™ç›’"ä¸­å·¥ä½œ
```

**3. å¹¶å‘å¤„ç†å¤šä¸ªä»»åŠ¡**
```
å¯ä»¥åŒæ—¶å¯åŠ¨å¤šä¸ª Sub Agent
    â†“
æ¯ä¸ªéƒ½æœ‰ç‹¬ç«‹çš„ä¸Šä¸‹æ–‡
    â†“
äº’ä¸å¹²æ‰°ï¼Œå¹¶è¡Œæ‰§è¡Œ
```

### å¹¶å‘èƒ½åŠ›

Sub Agent æ”¯æŒå¼ºå¤§çš„å¹¶å‘æ‰§è¡Œï¼Œæœ€å¤šå¯åŒæ—¶è¿è¡Œ **49 ä¸ªå­ä»£ç†**ï¼š

```bash
# åŒæ—¶å®¡æŸ¥å¤šä¸ªæ¨¡å—
> å¯åŠ¨å‰ç«¯å®¡æŸ¥ä»£ç†æ£€æŸ¥ src/components/
> å¯åŠ¨åç«¯å®¡æŸ¥ä»£ç†æ£€æŸ¥ api/
> å¯åŠ¨æ•°æ®åº“å®¡æŸ¥ä»£ç†æ£€æŸ¥ db/
> å¯åŠ¨æµ‹è¯•å®¡æŸ¥ä»£ç†æ£€æŸ¥ tests/

# å››ä¸ªä»£ç†å¹¶å‘æ‰§è¡Œï¼Œå„è‡ªç‹¬ç«‹
```

è¿™ç§å¹¶å‘èƒ½åŠ›ä½¿å¾—å¤§å‹é¡¹ç›®çš„ä»»åŠ¡åˆ†è§£å’Œå¹¶è¡Œæ‰§è¡Œæˆä¸ºå¯èƒ½ã€‚

### Sub Agent é…ç½®æ ¼å¼

```yaml
---
name: code-reviewer
description: ä¸“ä¸šä»£ç å®¡æŸ¥ä¸“å®¶ã€‚ä¸»åŠ¨å®¡æŸ¥ä»£ç è´¨é‡ã€å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚åœ¨ç¼–å†™æˆ–ä¿®æ”¹ä»£ç åå¿…é¡»ç«‹å³ä½¿ç”¨ã€‚
tools: file_search, bash, file_edit
color: red
---

# ä»£ç å®¡æŸ¥ä¸“å®¶

ä½ æ˜¯ä¸€ä½èµ„æ·±ä»£ç å®¡æŸ¥ä¸“å®¶ï¼Œè‡´åŠ›äºç¡®ä¿ä»£ç è´¨é‡å’Œå®‰å…¨æ€§çš„é«˜æ ‡å‡†ã€‚

## å®¡æŸ¥æ¸…å•
- ä»£ç ç®€æ´æ˜“è¯»
- å‡½æ•°å’Œå˜é‡å‘½åæ¸…æ™°
- æ— é‡å¤ä»£ç 
- é€‚å½“çš„é”™è¯¯å¤„ç†
- æ— æš´éœ²çš„å¯†é’¥æˆ– API å¯†é’¥
- å®ç°äº†è¾“å…¥éªŒè¯
- è‰¯å¥½çš„æµ‹è¯•è¦†ç›–ç‡

## å·¥ä½œæ–¹å¼
1. è¿è¡Œ git diff æŸ¥çœ‹æœ€è¿‘çš„æ›´æ”¹
2. ä¸“æ³¨äºå·²ä¿®æ”¹çš„æ–‡ä»¶
3. æŒ‰ä¼˜å…ˆçº§ç»„ç»‡åé¦ˆï¼ˆä¸¥é‡/è­¦å‘Š/å»ºè®®ï¼‰
```

### å­˜å‚¨ä½ç½®ä¸ä¼˜å…ˆçº§

| **ç±»å‹** | **ä½ç½®** | **èŒƒå›´** | **ä¼˜å…ˆçº§** |
|---------|---------|---------|-----------|
| é¡¹ç›® Sub Agent | `.claude/agents/` | å½“å‰é¡¹ç›® | æœ€é«˜ |
| ç”¨æˆ· Sub Agent | `~/.claude/agents/` | æ‰€æœ‰é¡¹ç›® | è¾ƒä½ |

é¡¹ç›®çº§åˆ«çš„ Sub Agent ä¼šè¦†ç›–ç”¨æˆ·çº§åˆ«çš„åŒåä»£ç†ï¼Œè¿™ç¡®ä¿äº†é¡¹ç›®ç‰¹å®šéœ€æ±‚çš„çµæ´»æ€§ã€‚

### è°ƒç”¨æ–¹å¼

#### 1. è‡ªåŠ¨å§”æ‰˜

Claude Code ä¼šæ ¹æ®ä»»åŠ¡æè¿°ã€Sub Agent æè¿°å’Œå½“å‰ä¸Šä¸‹æ–‡ä¸»åŠ¨é€‰æ‹©åˆé€‚çš„å­ä»£ç†ï¼š

```
ç”¨æˆ·ï¼šå¸®æˆ‘æ£€æŸ¥ä¸€ä¸‹è¿™æ®µä»£ç çš„è´¨é‡
    â†“
Claude è¯†åˆ«è¿™æ˜¯ä¸€ä¸ªä»£ç å®¡æŸ¥ä»»åŠ¡
    â†“
è‡ªåŠ¨å§”æ‰˜ç»™ code-reviewer Sub Agent
    â†“
Sub Agent åœ¨ç‹¬ç«‹ä¸Šä¸‹æ–‡ä¸­å®Œæˆå®¡æŸ¥
    â†“
è¿”å›ç®€æ´çš„ç»“æœç»™ä¸»å¯¹è¯
```

#### 2. æ˜¾å¼è°ƒç”¨

```bash
# é€šè¿‡åç§°ç›´æ¥è°ƒç”¨
> ç”¨ code-reviewer æ£€æŸ¥è¿™ä¸ªæ–‡ä»¶ï¼šmain.py
> è®© debugger åˆ†æè¿™ä¸ªé”™è¯¯
> å¯åŠ¨ data-scientist åˆ†æé”€å”®æ•°æ®
```

### å…¸å‹ Sub Agent ç¤ºä¾‹

#### ä»£ç å®¡æŸ¥ä¸“å®¶
```yaml
---
name: code-reviewer
description: ä¸“æ³¨äºä»£ç è´¨é‡ã€å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§
tools: file_search, bash, file_edit
---
# æ£€æŸ¥ PEP8 åˆè§„æ€§ã€æŸ¥æ‰¾æ½œåœ¨ bugã€æä¾›ä¼˜åŒ–å»ºè®®
```

#### è°ƒè¯•ä¸“å®¶
```yaml
---
name: debugger
description: é”™è¯¯è°ƒè¯•å’Œé—®é¢˜æ’æŸ¥ä¸“å®¶
tools: file_search, file_edit, bash
---
# åˆ†æé”™è¯¯æ—¥å¿—ã€è¿½è¸ªé—®é¢˜æ ¹æºã€å®æ–½ä¿®å¤
```

#### æ•°æ®ç§‘å­¦å®¶
```yaml
---
name: data-scientist
description: æ•°æ®åˆ†æå’Œ SQL æŸ¥è¯¢ä¸“å®¶
tools: bash, file_search, file_edit
---
# ç¼–å†™é«˜æ•ˆ SQLã€æ•°æ®æ¸…æ´—ã€ç»Ÿè®¡åˆ†æã€å¯è§†åŒ–
```

### Kiro å·¥ä½œæµï¼šè§„èŒƒé©±åŠ¨å¼€å‘

Sub Agent æœ€å¼ºå¤§çš„åº”ç”¨ä¹‹ä¸€æ˜¯æ¨¡ä»¿ AWS Kiro çš„è§„èŒƒé©±åŠ¨å¼€å‘å·¥ä½œæµï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           è§„èŒƒé©±åŠ¨å¼€å‘ï¼ˆSpec-Driven Developmentï¼‰         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  Phase 1: è§„åˆ’ï¼ˆPlanningï¼‰                               â”‚
â”‚  â””â”€â”€ @strategic-planner                                 â”‚
â”‚      â””â”€â”€ åˆ†æéœ€æ±‚ã€åˆ›å»ºæŠ€æœ¯è§„èŒƒã€ç”Ÿæˆä»»åŠ¡æ¸…å•              â”‚
â”‚                                                           â”‚
â”‚  Phase 2: æ‰§è¡Œï¼ˆExecutionï¼‰                              â”‚
â”‚  â””â”€â”€ @task-executor                                     â”‚
â”‚      â””â”€â”€ è¯»å–è§„èŒƒã€é€é¡¹å®ç°ã€å¤–ç§‘æ‰‹æœ¯èˆ¬çš„ç²¾ç¡®åº¦            â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

è¿™ç§æ–¹æ³•é€šè¿‡å¼•å…¥ç»“æ„åŒ–çš„"è®¡åˆ’ä¸æ‰§è¡Œ"æ¨¡å¼ï¼Œå–ä»£éšæ„çš„"æ°›å›´ç¼–ç¨‹"ï¼ˆvibe codingï¼‰ï¼Œäº§ç”Ÿå¯ç»´æŠ¤ã€ç”Ÿäº§å°±ç»ªçš„ä»£ç ã€‚

## å…­ã€Claude Skills ç³»ç»Ÿ

Skills æ˜¯ Claude Code æœ€å…·åˆ›æ–°æ€§çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå®ƒå°†"é€šç”¨ AI"è½¬å˜ä¸º"å®šåˆ¶ä¸“å®¶"ï¼Œä»£è¡¨äº† AI èƒ½åŠ›å¤ç”¨çš„ä¸€æ¬¡é‡è¦è·ƒè¿ã€‚

![Claude Code Skills](/images/claudecodeskills.png)

### ä»€ä¹ˆæ˜¯ Skillsï¼Ÿ

Skills æ˜¯ä¸€ç§**æ¨¡å—åŒ–çš„"èƒ½åŠ›åŒ…"æœºåˆ¶**ï¼Œå¯ä»¥å°†æŒ‡ä»¤ã€è„šæœ¬ã€æ¨¡æ¿ã€èµ„æºç­‰æ‰“åŒ…ä¸ºå¯å¤ç”¨çš„ Skillã€‚å½“ Claude è®¤ä¸ºæŸä¸ªä»»åŠ¡ç›¸å…³æ—¶ï¼Œå®ƒä¼šåŠ¨æ€åŠ è½½å¯¹åº”çš„ Skill æ¥æ‰§è¡Œä»»åŠ¡ã€‚

ä¸ä¼ ç»Ÿ prompt ä¸åŒï¼ŒSkills ä¸æ˜¯ä¸€æ¬¡æ€§æŒ‡ä»¤ï¼Œè€Œæ˜¯ä¸€ç§å¯ä»¥å°è£…å¤æ‚é€»è¾‘ã€æ¨¡æ¿ã€è„šæœ¬ã€æ–‡ä»¶æ“ä½œã€ç”šè‡³å¤šæ­¥éª¤å·¥ä½œæµçš„å®Œæ•´èƒ½åŠ›å•å…ƒã€‚

```
Skills = çŸ¥è¯† + æµç¨‹ + æ¨¡æ¿ + è„šæœ¬/å·¥å…·è°ƒç”¨
```

### æ ¸å¿ƒæŠ€æœ¯åŸç†

#### 1. æ¸è¿›å¼æŠ«éœ²ï¼ˆProgressive Disclosureï¼‰

è¿™æ˜¯ Skills è®¾è®¡ä¸­æœ€ç²¾å¦™çš„éƒ¨åˆ†ï¼Œè§£å†³äº†"å¤§é‡ Skills å¦‚ä½•ä¸å½±å“æ€§èƒ½"çš„é—®é¢˜ï¼š

```
ç¬¬ä¸€é˜¶æ®µï¼ˆåˆå§‹ï¼‰: åªåŠ è½½ metadataï¼ˆname, description, tagsï¼‰
                    â†“ å‡ åä¸ª token
ç¬¬äºŒé˜¶æ®µï¼ˆåŒ¹é…åï¼‰: åŠ è½½ SKILL.md ä¸»è¦æ–‡æ¡£
                    â†“ åªæœ‰éœ€è¦æ—¶æ‰åŠ è½½
ç¬¬ä¸‰é˜¶æ®µï¼ˆæ‰§è¡Œæ—¶ï¼‰: åŠ è½½è„šæœ¬/èµ„æº/æ¨¡æ¿
                    â†“ æŒ‰éœ€åŠ è½½ï¼Œé¿å… token çˆ†ç‚¸
```

è¿™ç§åˆ†å±‚æŠ«éœ²ç­–ç•¥ä½¿å¾—å³ä½¿å®‰è£…äº†å¤§é‡ Skillsï¼Œä¹Ÿä¸ä¼šä¸¥é‡å½±å“ä¸Šä¸‹æ–‡çª—å£æˆ–æ€§èƒ½ã€‚

![â€â¤â¡The Skills architecture](/images/agent-skills-architecture.png)

#### 2. å¯ç»„åˆæ€§ï¼ˆComposableï¼‰

å¤šä¸ª Skill å¯ä»¥åŒæ—¶è¢«è§¦å‘å’Œç»„åˆä½¿ç”¨ï¼š

```typescript
// ä»»åŠ¡ï¼šåˆ†æ Excel æ•°æ® â†’ ç”Ÿæˆå›¾è¡¨ â†’ å¯¼å‡º PPT â†’ è½¬ä¸º PDF

Claude å¯ä»¥ä¾æ¬¡æˆ–å¹¶è¡Œè°ƒç”¨ï¼š
â”œâ”€â”€ Data Analysis Skill    // åˆ†ææ•°æ®
â”œâ”€â”€ Excel Skill             // å¤„ç†è¡¨æ ¼
â”œâ”€â”€ Chart Generation Skill  // ç”Ÿæˆå›¾è¡¨
â”œâ”€â”€ PPT Skill               // ç”Ÿæˆæ¼”ç¤ºæ–‡ç¨¿
â””â”€â”€ PDF Skill               // å¯¼å‡ºæ–‡æ¡£
```

è¿™ç§å¯ç»„åˆæ€§ä½¿å¾—å¤æ‚ã€å¤šæ­¥éª¤ã€è·¨å·¥å…·çš„å·¥ä½œæµè‡ªåŠ¨åŒ–æˆä¸ºå¯èƒ½ã€‚

#### 3. å¯ç§»æ¤æ€§ä¸ç»Ÿä¸€æ ¼å¼

æ— è®ºæ˜¯åœ¨ Claude Webã€Claude Codeã€è¿˜æ˜¯é€šè¿‡ Claude APIï¼Œéƒ½å¯ä»¥åŠ è½½åŒä¸€ä¸ª Skillï¼š

```
ä¸€æ¬¡ç¼–å†™ï¼Œå¤šå¤„å¤ç”¨
    â†“
æ ‡å‡†åŒ–ä¼ä¸šæµç¨‹
    â†“
å›¢é˜Ÿå…±äº«ï¼Œä¸€è‡´è¾“å‡º
```

### Skill æ–‡ä»¶ç»“æ„

ä¸€ä¸ªå…¸å‹çš„ Skill ç›®å½•ç»“æ„ï¼š

```
my_custom_skill/
â”œâ”€â”€ SKILL.md              # å¿…éœ€ï¼šåŒ…å« metadata + æŒ‡ä»¤
â”œâ”€â”€ README.md             # å¯é€‰ï¼šè¯´æ˜ç”¨é€”ã€ç‰ˆæœ¬å†å²
â”œâ”€â”€ instructions.txt      # å¯é€‰ï¼šè‡ªç„¶è¯­è¨€æŒ‡ä»¤
â”œâ”€â”€ scripts/              # å¯é€‰ï¼šå¯æ‰§è¡Œè„šæœ¬
â”‚   â””â”€â”€ run.py
â”œâ”€â”€ assets/               # å¯é€‰ï¼šæ¨¡æ¿/ç¤ºä¾‹æ–‡ä»¶
â”‚   â”œâ”€â”€ template.xlsx
â”‚   â””â”€â”€ style_guide.docx
â””â”€â”€ examples/             # å¯é€‰ï¼šç¤ºä¾‹è¾“å…¥/è¾“å‡º
    â”œâ”€â”€ sample_input.json
    â””â”€â”€ expected_output.xlsx
```

### SKILL.md ç¤ºä¾‹

```markdown
---
name: Company-Brand-Report
description: "ä¸ºå…¬å¸ç”Ÿæˆæ ‡å‡†å“ç‰Œæ ¼å¼çš„æŠ¥å‘Šï¼šè¯»å– CSV æ•°æ®ï¼Œç”Ÿæˆ Excel è¡¨æ ¼ + å›¾è¡¨ + å¯¼å‡º PDF"
---

# Company-Brand-Report Skill

## ä½¿ç”¨åœºæ™¯
å½“ä½ æä¾›åŸå§‹æ•°æ®ï¼ˆCSV/JSONï¼‰æ—¶ï¼ŒClaude ä¼šï¼š
1. è¯»å–å¹¶åˆ†ææ•°æ®
2. æŒ‰å…¬å¸æ¨¡æ¿ç”Ÿæˆ Excel æŠ¥è¡¨
3. æ’å…¥å›¾è¡¨ï¼ˆæŸ±çŠ¶/æŠ˜çº¿/é¥¼å›¾ï¼‰
4. å¯¼å‡ºä¸º PDFï¼ŒåµŒå…¥å…¬å¸å°é¢

## æŒ‡ä»¤
1. è¯»å–ä¼ å…¥çš„ CSV/JSON æ•°æ®
2. æŒ‰ç…§å…¬å¸æ¨¡æ¿æ ¼å¼ç”Ÿæˆ Excel æŠ¥è¡¨
3. æ’å…¥å¯è§†åŒ–å›¾è¡¨
4. å¯¼å‡º PDF å¹¶åº”ç”¨å“ç‰Œæ ·å¼
5. è¿”å›ç”Ÿæˆæ–‡ä»¶

## æ³¨æ„äº‹é¡¹
- ä»…å¤„ç†ç»“æ„åŒ–æ•°æ®ï¼ˆCSV/JSONï¼‰
- é¿å…å¯¼å…¥å¤–éƒ¨ç½‘ç»œèµ„æº
- ä½¿ç”¨å…¬å¸æŒ‡å®šçš„é¢œè‰²å’Œå­—ä½“
```

### å…¸å‹åº”ç”¨åœºæ™¯

**1. ä¼ä¸šå“ç‰Œ/æ–‡æ¡£è§„èŒƒç»Ÿä¸€**
```
å°†å…¬å¸å“ç‰Œå­—ä½“ã€æ ·å¼ã€æ’ç‰ˆè§„èŒƒå°è£…ä¸º Skill
    â†“
æ‰€æœ‰ç”Ÿæˆæ–‡æ¡£éƒ½ç¬¦åˆå“ç‰Œæ ‡å‡†
```

**2. è‡ªåŠ¨åŒ–æŠ¥å‘Šç”Ÿæˆ**
```
åŸå§‹æ•°æ® â†’ Excel åˆ†æ â†’ å›¾è¡¨å¯è§†åŒ– â†’ æŠ¥å‘Š â†’ PDF å¯¼å‡º
    â†“
ä¸€é”®å®Œæˆï¼Œé›¶äººå·¥å¹²é¢„
```

**3. åˆåŒ/æ–‡æ¡£åˆè§„æ£€æŸ¥**
```
è¾“å…¥åˆåŒ â†’ Skill æ£€æŸ¥åˆè§„æ€§ â†’ æ£€æµ‹æ•æ„Ÿè¯ â†’ å¡«å……æ¨¡æ¿
    â†“
æ ‡å‡†åŒ–è¾“å‡ºï¼Œé™ä½é£é™©
```

### å®‰å…¨é£é™©ä¸æ²»ç†

Skills çš„å¼ºå¤§åŠŸèƒ½ä¹Ÿå¸¦æ¥äº†ä¸¥å³»çš„å®‰å…¨æŒ‘æˆ˜ï¼Œè¿™æ˜¯ä½¿ç”¨æ—¶å¿…é¡»æ³¨æ„çš„ï¼š

#### âš ï¸ å·²çŸ¥å®‰å…¨é£é™©

**1. æ¶æ„ä»£ç æ³¨å…¥**
```
æ”»å‡»è€…å¯ä»¥åˆ›å»ºçœ‹ä¼¼æ­£å¸¸çš„ Skill
    â†“
åœ¨è„šæœ¬ä¸­åµŒå…¥å‹’ç´¢è½¯ä»¶ï¼ˆå¦‚ MedusaLockerï¼‰
    â†“
ç”¨æˆ·æ‰¹å‡†åï¼Œä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„ payload
```

**2. Prompt Injection**
```
Skill çš„ markdown æ–‡ä»¶å’Œè„šæœ¬ä¸­
    â†“
éšè—æ¶æ„æŒ‡ä»¤
    â†“
è§¦å‘æ•°æ®çªƒå–æˆ–æ•æ„Ÿä¿¡æ¯æ³„éœ²
```

#### ğŸ” æ²»ç†å¯¹ç­–

```yaml
å®‰å…¨æœ€ä½³å®è·µ:
  ä»…ä»å¯ä¿¡æ¥æºå®‰è£… Skill: true
  å®¡æŸ¥ Skill å†…å®¹ï¼ˆè„šæœ¬ã€ä¾èµ–ï¼‰: true
  å»ºç«‹ Skill å®¡æ‰¹æµç¨‹: true
  é™åˆ¶ç½‘ç»œè®¿é—®å’Œå¤–éƒ¨ä¸‹è½½: true
  æŒç»­ç›‘æ§å’Œæ—¥å¿—è®°å½•: true

ä¼ä¸šçº§ç®¡ç†:
  ç‰ˆæœ¬æ§åˆ¶: true
  æƒé™åˆ†çº§: true
  ä»£ç å®¡æŸ¥: true
  å®‰å…¨å®¡è®¡: true
  å›æ»šæœºåˆ¶: true
```

### Skills ä¸ MCP çš„å¯¹æ¯”

| **ç»´åº¦** | **Skills** | **MCP** |
|---------|-----------|---------|
| **å…³æ³¨ç‚¹** | å¦‚ä½•å®Œæˆä»»åŠ¡ï¼ˆå†…éƒ¨æµç¨‹ï¼‰ | è¿æ¥å¤–éƒ¨å·¥å…·ä¸æ•°æ®æº |
| **å†…å®¹** | äººç±»æµç¨‹/SOP/æ¨¡æ¿ | å¤–éƒ¨å·¥å…·/API/æ•°æ®æº |
| **Token æ•ˆç‡** | æé«˜ï¼ˆæ¸è¿›å¼æŠ«éœ²ï¼‰ | å¯èƒ½æ¶ˆè€—å¤§é‡ Token |
| **æ‰§è¡Œèƒ½åŠ›** | å¯åŒ…å«è„šæœ¬é€»è¾‘ | ä¾èµ–å¤–éƒ¨æœåŠ¡ |
| **é€‚ç”¨åœºæ™¯** | æ–‡æ¡£ç”Ÿæˆã€æ ¼å¼åŒ–ã€åˆè§„æ£€æŸ¥ | è®¿é—® GitHubã€æ•°æ®åº“ã€API |

ä¸¤è€…ååŒï¼šç”¨ MCP è·å–å®æ—¶æ•°æ®ï¼Œç”¨ Skill åˆ†ææ•°æ®å¹¶ç”ŸæˆæŠ¥å‘Šã€‚

## ä¸ƒã€Skills vs Sub Agentï¼šå¦‚ä½•é€‰æ‹©ï¼Ÿ

ç†è§£ Skills å’Œ Sub Agents çš„åŒºåˆ«å¯¹äºæ­£ç¡®ä½¿ç”¨ Claude Code è‡³å…³é‡è¦ã€‚å®ƒä»¬è™½ç„¶éƒ½ç”¨äºæ‰©å±• Claude çš„èƒ½åŠ›ï¼Œä½†è®¾è®¡å“²å­¦å’Œä½¿ç”¨åœºæ™¯å®Œå…¨ä¸åŒã€‚

### æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”

| **ç»´åº¦** | **Skills** | **Sub Agents** |
|---------|-----------|---------------|
| **å®šä¹‰** | è‡ªåŠ¨è§¦å‘çš„"èƒ½åŠ›æ’ä»¶" | ä¸“ä¸šå­ä»£ç†ï¼Œå°å‹ AI ä¸“å®¶ |
| **è§¦å‘æ–¹å¼** | Claude æ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨è¯†åˆ« | å¯è‡ªåŠ¨å§”æ´¾æˆ–æ‰‹åŠ¨æŒ‡å®š |
| **ä¸Šä¸‹æ–‡** | ä¸ä¸»ä¼šè¯å…±äº«ä¸Šä¸‹æ–‡ | **æ‹¥æœ‰ç‹¬ç«‹çš„ä¸Šä¸‹æ–‡çª—å£** |
| **é€‚ç”¨ä»»åŠ¡** | ç®€å•ã€é‡å¤æ€§ä»»åŠ¡ | å¤æ‚ã€å¤šæ­¥éª¤ä»»åŠ¡ |
| **é…ç½®æ–¹å¼** | æ–‡ä»¶å¤¹ï¼ˆSKILL.md + è„šæœ¬ï¼‰ | å•ä¸ª .md æ–‡ä»¶ |
| **å¹¶å‘èƒ½åŠ›** | ä¸æ”¯æŒå¹¶å‘ | æ”¯æŒæœ€å¤š 49 ä¸ªå¹¶å‘ |
| **Token æ•ˆç‡** | æé«˜ï¼ˆæ¸è¿›å¼æŠ«éœ²ï¼‰ | å ç”¨ç‹¬ç«‹ä¸Šä¸‹æ–‡ |
| **å·¥å…·æƒé™** | ç»§æ‰¿ä¸»ä¼šè¯æƒé™ | å¯ç‹¬ç«‹é…ç½® |

### ä½¿ç”¨åœºæ™¯å†³ç­–æ ‘

```
ä½ çš„ä»»åŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ
    â”‚
    â”œâ”€ ç®€å•ã€é‡å¤ã€å¯ç¨‹åºåŒ–ï¼Ÿ
    â”‚   â””â”€ â†’ ä½¿ç”¨ Skill
    â”‚       ä¾‹ï¼šæ ¼å¼åŒ– JSONã€å‘½åè§„èŒƒæ£€æŸ¥
    â”‚
    â”œâ”€ å¤æ‚ã€å¤šæ­¥éª¤ã€éœ€è¦æ·±åº¦åˆ†æï¼Ÿ
    â”‚   â””â”€ â†’ ä½¿ç”¨ Sub Agent
    â”‚       ä¾‹ï¼šä»£ç å®¡æŸ¥ã€æ€§èƒ½åˆ†æã€é‡æ„
    â”‚
    â”œâ”€ éœ€è¦ä¿æŒä¸»å¯¹è¯æ¸…çˆ½ï¼Ÿ
    â”‚   â””â”€ â†’ ä½¿ç”¨ Sub Agentï¼ˆä¸Šä¸‹æ–‡éš”ç¦»ï¼‰
    â”‚       ä¾‹ï¼šå¤§å‹ä»£ç å®¡æŸ¥ã€æ•°æ®åˆ†æ
    â”‚
    â””â”€ éœ€è¦å¹¶è¡Œå¤„ç†å¤šä¸ªä»»åŠ¡ï¼Ÿ
        â””â”€ â†’ ä½¿ç”¨å¤šä¸ª Sub Agent
            ä¾‹ï¼šåŒæ—¶å®¡æŸ¥å¤šä¸ªæ¨¡å—
```

### å®é™…åº”ç”¨ç¤ºä¾‹

#### åœºæ™¯ 1ï¼šä»£ç æ ¼å¼åŒ– â†’ ä½¿ç”¨ Skill

```bash
# ç®€å•ä»»åŠ¡ï¼šæ ¼å¼åŒ– JSON æ–‡ä»¶
> æ ¼å¼åŒ–è¿™ä¸ª JSON æ–‡ä»¶

Claude è‡ªåŠ¨è¯†åˆ«å¹¶è°ƒç”¨ JSON Formatter Skill
    â†“
åœ¨ä¸»å¯¹è¯ä¸­ç›´æ¥å®Œæˆ
    â†“
å¿«é€Ÿã€ç®€æ´ã€ä¸å ç”¨é¢å¤–ä¸Šä¸‹æ–‡
```

#### åœºæ™¯ 2ï¼šå…¨é¢ä»£ç å®¡æŸ¥ â†’ ä½¿ç”¨ Sub Agent

```bash
# å¤æ‚ä»»åŠ¡ï¼šå…¨é¢çš„ä»£ç å®¡æŸ¥
> ç”¨ code-reviewer å®¡æŸ¥æœ€è¿‘çš„ä¿®æ”¹

å§”æ‰˜ç»™ code-reviewer Sub Agent
    â†“
Sub Agent åœ¨ç‹¬ç«‹ä¸Šä¸‹æ–‡ä¸­å·¥ä½œ
    â†“
è¯¦ç»†åˆ†æä»£ç è´¨é‡ã€å®‰å…¨æ€§ã€æ€§èƒ½
    â†“
è¿”å›ç®€æ´çš„å®¡æŸ¥æŠ¥å‘Šç»™ä¸»å¯¹è¯
    â†“
ä¸»å¯¹è¯ä¿æŒæ¸…çˆ½ï¼Œä¸è¢«ç»†èŠ‚æ±¡æŸ“
```

#### åœºæ™¯ 3ï¼šå¤§å‹é¡¹ç›®åˆ†æ â†’ ä½¿ç”¨å¤šä¸ª Sub Agent

```bash
# å¹¶è¡Œä»»åŠ¡ï¼šåˆ†æå¤§å‹é¡¹ç›®
> å¯åŠ¨å‰ç«¯ä»£ç†æ£€æŸ¥ src/components/
> å¯åŠ¨åç«¯ä»£ç†æ£€æŸ¥ api/
> å¯åŠ¨æ•°æ®åº“ä»£ç†æ£€æŸ¥ db/

ä¸‰ä¸ª Sub Agent å¹¶å‘æ‰§è¡Œ
    â†“
å„è‡ªåœ¨ç‹¬ç«‹ä¸Šä¸‹æ–‡ä¸­å·¥ä½œ
    â†“
äº’ä¸å¹²æ‰°ï¼ŒåŒæ—¶å®Œæˆ
    â†“
æ±‡æ€»ç»“æœç»™ä¸»å¯¹è¯
```

### ååŒä½¿ç”¨

Skills å’Œ Sub Agents å¯ä»¥ååŒå·¥ä½œï¼Œå‘æŒ¥å„è‡ªä¼˜åŠ¿ï¼š

```typescript
// å¤æ‚å·¥ä½œæµç¤ºä¾‹

ä¸»å¯¹è¯ï¼šè§„åˆ’æ•´ä¸ªé‡æ„ä»»åŠ¡
    â†“
Sub Agentï¼ˆarchitectï¼‰ï¼šåˆ†ææ¶æ„
    â†“
Sub Agentï¼ˆcode-reviewerï¼‰ï¼šå®¡æŸ¥ç°æœ‰ä»£ç 
    â†“
Skillï¼ˆformatterï¼‰ï¼šæ ¼å¼åŒ–ä¿®æ”¹åçš„ä»£ç 
    â†“
ä¸»å¯¹è¯ï¼šæ±‡æ€»ç»“æœï¼Œç”ŸæˆæŠ¥å‘Š
```

### æœ€ä½³å®è·µå»ºè®®

**1. ä¼˜å…ˆä½¿ç”¨ Skills çš„åœºæ™¯**
```
âœ… ç¨‹åºåŒ–å†™ä½œï¼ˆæ–‡æ¡£ç”Ÿæˆã€æŠ¥å‘Šæ ¼å¼åŒ–ï¼‰
âœ… ç®€å•çš„ä»£ç è§„èŒƒæ£€æŸ¥
âœ… å›ºå®šæµç¨‹çš„è‡ªåŠ¨åŒ–
âœ… éœ€è¦å¿«é€Ÿæ‰§è¡Œçš„å°ä»»åŠ¡
```

**2. ä¼˜å…ˆä½¿ç”¨ Sub Agents çš„åœºæ™¯**
```
âœ… éœ€è¦æ·±åº¦åˆ†æçš„ä»£ç å®¡æŸ¥
âœ… å¤æ‚çš„å¤šæ­¥éª¤ä»»åŠ¡
âœ… éœ€è¦ä¿æŒä¸»å¯¹è¯æ¸…çˆ½çš„å¤§å‹ä»»åŠ¡
âœ… éœ€è¦å¹¶è¡Œå¤„ç†çš„å¤šä¸ªä»»åŠ¡
âœ… éœ€è¦ä¸“ä¸šåŒ–çŸ¥è¯†çš„é¢†åŸŸä»»åŠ¡
```

**3. æ··åˆä½¿ç”¨çš„åœºæ™¯**
```
âœ… Sub Agent å®Œæˆå¤æ‚åˆ†æ
âœ… Skill å¤„ç†æ ¼å¼åŒ–å’Œæ ‡å‡†åŒ–
âœ… ä¸»å¯¹è¯è´Ÿè´£é«˜å±‚æ¬¡çš„è§„åˆ’å’Œå†³ç­–
```

## ä¹ã€Binary Feedback æœºåˆ¶

è¿™æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯• prompt ç¨³å®šæ€§çš„åˆ›æ–°æœºåˆ¶ï¼š

```typescript
async function queryWithBinaryFeedback(
  toolUseContext: ToolUseContext,
  getAssistantResponse: () => Promise<AssistantMessage>,
  getBinaryFeedbackResponse?: (m1, m2) => Promise<BinaryFeedbackResult>,
): Promise<BinaryFeedbackResult> {
  if (process.env.USER_TYPE !== 'ant' || !shouldUseBinaryFeedback()) {
    return normalQuery()
  }

  // ä½¿ç”¨å®Œå…¨ç›¸åŒçš„è¯·æ±‚ä¸¤æ¬¡
  const [m1, m2] = await Promise.all([
    getAssistantResponse(),
    getAssistantResponse(),
  ])

  // æ£€æµ‹ tool use æ˜¯å¦ç›¸åŒ
  if (hasSameToolUse(m1, m2)) {
    return m1  // æ¨¡å‹ç¡®å®šï¼Œè¿”å›ç»“æœ
  } else {
    return getBinaryFeedbackResponse(m1, m2)  // æ¨¡å‹çŠ¹è±«ï¼Œè¯·æ±‚ç”¨æˆ·é€‰æ‹©
  }
}
```

**æ ¸å¿ƒæ€æƒ³**ï¼šå¦‚æœ AI å¯¹ç›¸åŒè¾“å…¥è¿”å›ä¸¤ä¸ªä¸åŒç­”æ¡ˆï¼Œè¯´æ˜æ¨¡å‹å¯¹è¿™æ¬¡è¯·æ±‚çŠ¹è±«ï¼Œéœ€è¦ç”¨æˆ·é€‰æ‹©ã€‚

## åã€å®‰å…¨æœºåˆ¶

### AI è¾…åŠ©å®‰å…¨æ£€æµ‹

åˆ©ç”¨ AI åˆ¤æ–­å‘½ä»¤æ˜¯å¦æœ‰è¢«æ³¨å…¥çš„å¯èƒ½æ€§ï¼š

```typescript
export const getCommandSubcommandPrefix = memoize(
  async (command: string, abortSignal: AbortSignal) => {
    const subcommands = splitCommand(command)

    // è·å–å‘½ä»¤å‰ç¼€æ¥è§‚å¯Ÿæ˜¯å¦åœ¨å®‰å…¨æ‰§è¡Œåˆ—è¡¨
    const [fullCommandPrefix, ...subcommandPrefixesResults] = await Promise.all([
      getCommandPrefix(command, abortSignal),
      ...subcommands.map(async subcommand => ({
        subcommand,
        prefix: await getCommandPrefix(subcommand, abortSignal),
      })),
    ])
  }
)
```

### ä¸Šä¸‹æ–‡å‹ç¼©å¤„ç†

å½“å¯¹è¯è¿‡é•¿æ—¶ï¼Œä½¿ç”¨ Sonnet æ¨¡å‹ç”Ÿæˆæ‘˜è¦ï¼Œæ¸…ç©ºå†å²ä½†ä¿ç•™å…³é”®ä¿¡æ¯ï¼š

1. è·å–å½“å‰å¯¹è¯å†å²
2. æ„é€ æ‘˜è¦è¯·æ±‚å¹¶è°ƒç”¨ Sonnet æ¨¡å‹
3. æå–å¹¶éªŒè¯æ‘˜è¦å†…å®¹
4. æ¸…å±ã€æ¸…ç©ºæ¶ˆæ¯å†å²
5. åˆ›å»ºåŒ…å«æ‘˜è¦çš„æ–°å¯¹è¯åˆ†æ”¯

## åä¸€ã€æ¨¡å‹é€‰æ‹©ç­–ç•¥

Claude Code å†…éƒ¨æœ‰å¤šä¸ªæ¨¡å‹å®ä¾‹ï¼Œæ ¹æ®ä»»åŠ¡å¤æ‚åº¦é€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼š

- **Haiku**ï¼šç®€å•ä»»åŠ¡ï¼ˆåˆ¤æ–­å¯¹é”™ã€ç¡®è®¤å‰ç¼€ç­‰ï¼‰
- **Sonnet**ï¼šæ‘˜è¦ç”Ÿæˆç­‰ä¸­ç­‰ä»»åŠ¡
- **Opus**ï¼šå¤æ‚ç¼–ç¨‹ä»»åŠ¡

```typescript
// ç®€å•ä»»åŠ¡ä½¿ç”¨ Haiku
async function generateTitle(description: string): Promise<string> {
  const response = await queryHaiku({
    systemPrompt: ['Generate a concise issue title (max 80 chars)...'],
    userPrompt: description,
  })
  return response.message.content[0]?.text || 'Bug Report'
}
```

## åäºŒã€æŠ€æœ¯å¯ç¤º

Claude Code çš„æ¶æ„è®¾è®¡ç»™æˆ‘ä»¬å¸¦æ¥äº†ä¸€äº›é‡è¦å¯ç¤ºï¼š

### 1. åˆ†å±‚æ¶æ„çš„ä»·å€¼

æ¸…æ™°çš„åˆ†å±‚ä½¿ç³»ç»Ÿæ—¢å¼ºå¤§åˆæ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚

### 2. Token æ•ˆç‡çš„é‡è¦æ€§

é€šè¿‡ LRU ç¼“å­˜ã€æŒ‰éœ€åŠ è½½ã€æ¸è¿›å¼æŠ«éœ²ç­‰æœºåˆ¶ï¼Œæœ€å¤§åŒ–åˆ©ç”¨æœ‰é™çš„ä¸Šä¸‹æ–‡çª—å£ã€‚

### 3. å·¥å…·ç³»ç»Ÿçš„æ‰©å±•æ€§

ç»Ÿä¸€çš„å·¥å…·æ¥å£ + MCP åè®®ï¼Œä½¿ç³»ç»Ÿèƒ½å¤Ÿè½»æ¾é›†æˆæ–°çš„èƒ½åŠ›ã€‚

### 4. å­ä»£ç†çš„ä¸“ä¸šåŒ–

å°†å¤æ‚ä»»åŠ¡å§”æ‰˜ç»™ä¸“ä¸šåŒ–çš„å­ä»£ç†ï¼Œæé«˜æ‰§è¡Œè´¨é‡å’Œæ•ˆç‡ã€‚

### 5. Skills çš„å®ç”¨æ€§

å°†éšæ€§çŸ¥è¯†è½¬åŒ–ä¸ºå¯å¤ç”¨çš„æŠ€èƒ½åŒ…ï¼Œè®© AI çœŸæ­£èå…¥æ—¥å¸¸å·¥ä½œæµç¨‹ã€‚

## ç»“è¯­

Claude Code ä¸ä»…ä»…æ˜¯ä¸€ä¸ª AI ç¼–ç¨‹å·¥å…·ï¼Œæ›´æ˜¯ä¸€ä¸ªå®Œæ•´çš„æŠ€æœ¯æ¶æ„èŒƒä¾‹ã€‚å®ƒçš„è®¾è®¡å“²å­¦ã€æŠ€æœ¯é€‰æ‹©å’Œå®ç°ç»†èŠ‚ï¼Œéƒ½ä¸ºæˆ‘ä»¬æ„å»ºä¸‹ä¸€ä»£ AI åº”ç”¨æä¾›äº†å®è´µçš„å‚è€ƒã€‚

ä»äº¤äº’å±‚åˆ°æ ¸å¿ƒå¼•æ“ï¼Œä»å·¥å…·ç³»ç»Ÿåˆ°ä¸Šä¸‹æ–‡ç®¡ç†ï¼Œä» MCP åˆ° Skillsï¼Œæ¯ä¸€é¡¹æŠ€æœ¯éƒ½ä½“ç°äº†å¯¹å¼€å‘è€…ä½“éªŒå’Œç³»ç»Ÿæ•ˆç‡çš„æ·±åˆ»æ€è€ƒã€‚

éšç€ Claude Code çš„ä¸æ–­æ¼”è¿›ï¼Œä»¥åŠå›½äº§å¤§æ¨¡å‹å’Œå·¥å…·çš„å´›èµ·ï¼Œæˆ‘ä»¬æœ‰ç†ç”±ç›¸ä¿¡ï¼ŒAI è¾…åŠ©ç¼–ç¨‹çš„æ—¶ä»£æ‰åˆšåˆšå¼€å§‹ã€‚

---

> *æ³¨ï¼šæœ¬æ–‡åŸºäº Claude Code çš„å…¬å¼€æŠ€æœ¯æ–‡æ¡£æ•´ç†ï¼Œç›¸å…³æŠ€æœ¯ä»åœ¨å¿«é€Ÿå‘å±•ä¸­ã€‚*
